// import gpxParser from "../Test_Algorithms/GPXparser";
// BACKEND CALCULATIONS
let gpx = require('./tokyo.json');
let L = Object.keys(gpx.time).length;
let bearings = [0];
let slopes = [0];
let distances = [0];
var pi = Math.PI;

function radians(degrees) { return degrees * (pi / 180); }
function degrees(radians) { return radians * (180 / pi); }

var getDistance = function (p1lat, p1lng, p2lat, p2lng) {
    var R = 6378137; // Earthâ€™s mean radius in meter
    var dLat = p2lat - p1lat;
    var dLong = p2lng - p1lng;
    var a = Math.sin(dLat / 2) * Math.sin(dLat / 2) +
        Math.cos(p1lat) * Math.cos(p2lat) *
        Math.sin(dLong / 2) * Math.sin(dLong / 2);
    var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
    var d = R * c;
    return d; // returns the distance in meter
};

var prev_dist = 0;
for (let i = 0; i < L - 1; i++) {
    let b1 = radians(gpx.latitude[i])
    let b2 = radians(gpx.latitude[i + 1])
    let d1 = radians(gpx.longitude[i])
    let d2 = radians(gpx.longitude[i + 1])
    let bearing = Math.atan2(Math.sin(d2 - d1) * Math.cos(b2), (Math.cos(b1) * Math.sin(b2)) - (Math.sin(b1) * Math.cos(b1) * Math.cos(d2 - d1))) % (2 * pi);
    bearings.push(degrees(bearing));
    let curr_dist = getDistance(b1, d1, b2, d2);
    slopes.push((gpx.altitude[i + 1] - gpx.altitude[i]) / curr_dist);

    prev_dist += curr_dist;
    distances.push(prev_dist);
}

let slope_percents = [slopes[1]];
for (let i = 2; i < L - 1; i++) {
    let slope_percent = (slopes[i - 1] + slopes[i] + slopes[i + 1]) / 3;
    slope_percents.push(slope_percent);
}
slope_percents.push((slopes[L - 2] + slopes[L - 1]) / 2);

// end BACKEND CALCULATIONS

// FRONTEND CALCULATIONS
// Columns needed: speed yaw_abs elevation power distance cda km/hr time w'
// Variables
var yaw_abs = [];
var power_in = [];
var cdas = [];
var wprimes = [];

const delta_cda = 0, delta_watts = -20, delta_kg = 0;
const dt = 0.5;
const cp = 430;
const mass = 71;
const mass_bike = 7;
const mass_other = 1;
const mass_total = mass + mass_bike + mass_other;
// Variables to calculate t' in part 9.
const wprime = 35000;
let wprime_ = 35000;
let w_recovery_function = 1;

const all_CDAs = {
    "a": {
        "10": [
            0.188,
            0.187624,
            0.18724800000000003,
            0.18687200000000004,
            0.18649600000000005,
            0.18612000000000006,
            0.18367600000000006,
            0.18123200000000006,
            0.17878800000000006,
            0.17634400000000006,
            0.17390000000000005,
            0.17390000000000005,
            0.17352400000000007,
            0.17314800000000008,
            0.1727720000000001,
            0.1723960000000001,
            0.17202000000000012,
            0.17164400000000013,
            0.17126800000000014,
            0.17089200000000015,
            0.17051600000000017,
            0.17014000000000018,
            0.1697640000000002,
            0.1693880000000002,
            0.16901200000000022,
            0.16863600000000023,
            0.16826000000000024,
            0.16788400000000026,
            0.16750800000000027,
            0.16713200000000028,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003
        ],
        "11": [
            0.188,
            0.187624,
            0.18724800000000003,
            0.18687200000000004,
            0.18649600000000005,
            0.18612000000000006,
            0.18367600000000006,
            0.18123200000000006,
            0.17878800000000006,
            0.17634400000000006,
            0.17390000000000005,
            0.17390000000000005,
            0.17352400000000007,
            0.17314800000000008,
            0.1727720000000001,
            0.1723960000000001,
            0.17202000000000012,
            0.17164400000000013,
            0.17126800000000014,
            0.17089200000000015,
            0.17051600000000017,
            0.17014000000000018,
            0.1697640000000002,
            0.1693880000000002,
            0.16901200000000022,
            0.16863600000000023,
            0.16826000000000024,
            0.16788400000000026,
            0.16750800000000027,
            0.16713200000000028,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003
        ],
        "12": [
            0.188,
            0.187624,
            0.18724800000000003,
            0.18687200000000004,
            0.18649600000000005,
            0.18612000000000006,
            0.18367600000000006,
            0.18123200000000006,
            0.17878800000000006,
            0.17634400000000006,
            0.17390000000000005,
            0.17390000000000005,
            0.17352400000000007,
            0.17314800000000008,
            0.1727720000000001,
            0.1723960000000001,
            0.17202000000000012,
            0.17164400000000013,
            0.17126800000000014,
            0.17089200000000015,
            0.17051600000000017,
            0.17014000000000018,
            0.1697640000000002,
            0.1693880000000002,
            0.16901200000000022,
            0.16863600000000023,
            0.16826000000000024,
            0.16788400000000026,
            0.16750800000000027,
            0.16713200000000028,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003
        ],
        "13": [
            0.186,
            0.185628,
            0.18525599999999998,
            0.18488399999999997,
            0.18451199999999995,
            0.18413999999999994,
            0.18172199999999994,
            0.17930399999999994,
            0.17688599999999993,
            0.17446799999999993,
            0.17204999999999993,
            0.17204999999999993,
            0.17167799999999991,
            0.1713059999999999,
            0.1709339999999999,
            0.17056199999999988,
            0.17018999999999987,
            0.16981799999999986,
            0.16944599999999985,
            0.16907399999999984,
            0.16870199999999982,
            0.1683299999999998,
            0.1679579999999998,
            0.1675859999999998,
            0.16721399999999978,
            0.16684199999999977,
            0.16646999999999976,
            0.16609799999999975,
            0.16572599999999973,
            0.16535399999999972,
            0.1649819999999997,
            0.1649819999999997,
            0.1649819999999997,
            0.1649819999999997,
            0.1649819999999997,
            0.1649819999999997,
            0.1649819999999997,
            0.1649819999999997,
            0.1649819999999997,
            0.1649819999999997,
            0.1649819999999997,
            0.1649819999999997,
            0.1649819999999997,
            0.1649819999999997,
            0.1649819999999997,
            0.1649819999999997,
            0.1649819999999997,
            0.1649819999999997,
            0.1649819999999997,
            0.1649819999999997,
            0.1649819999999997,
            0.1649819999999997,
            0.1649819999999997,
            0.1649819999999997,
            0.1649819999999997,
            0.1649819999999997,
            0.1649819999999997,
            0.1649819999999997,
            0.1649819999999997,
            0.1649819999999997,
            0.1649819999999997
        ],
        "14": [
            0.184,
            0.183632,
            0.18326399999999998,
            0.18289599999999998,
            0.18252799999999997,
            0.18215999999999996,
            0.17976799999999996,
            0.17737599999999995,
            0.17498399999999995,
            0.17259199999999994,
            0.17019999999999993,
            0.17019999999999993,
            0.16983199999999993,
            0.16946399999999992,
            0.1690959999999999,
            0.1687279999999999,
            0.1683599999999999,
            0.1679919999999999,
            0.16762399999999988,
            0.16725599999999988,
            0.16688799999999987,
            0.16651999999999986,
            0.16615199999999986,
            0.16578399999999985,
            0.16541599999999984,
            0.16504799999999983,
            0.16467999999999983,
            0.16431199999999982,
            0.1639439999999998,
            0.1635759999999998,
            0.1632079999999998,
            0.1632079999999998,
            0.1632079999999998,
            0.1632079999999998,
            0.1632079999999998,
            0.1632079999999998,
            0.1632079999999998,
            0.1632079999999998,
            0.1632079999999998,
            0.1632079999999998,
            0.1632079999999998,
            0.1632079999999998,
            0.1632079999999998,
            0.1632079999999998,
            0.1632079999999998,
            0.1632079999999998,
            0.1632079999999998,
            0.1632079999999998,
            0.1632079999999998,
            0.1632079999999998,
            0.1632079999999998,
            0.1632079999999998,
            0.1632079999999998,
            0.1632079999999998,
            0.1632079999999998,
            0.1632079999999998,
            0.1632079999999998,
            0.1632079999999998,
            0.1632079999999998,
            0.1632079999999998,
            0.1632079999999998
        ],
        "15": [
            0.183,
            0.182634,
            0.18226799999999999,
            0.18190199999999998,
            0.18153599999999998,
            0.18116999999999997,
            0.17879099999999998,
            0.17641199999999999,
            0.174033,
            0.171654,
            0.169275,
            0.169275,
            0.168909,
            0.168543,
            0.168177,
            0.167811,
            0.16744499999999998,
            0.16707899999999998,
            0.16671299999999997,
            0.16634699999999997,
            0.16598099999999996,
            0.16561499999999996,
            0.16524899999999995,
            0.16488299999999995,
            0.16451699999999994,
            0.16415099999999994,
            0.16378499999999993,
            0.16341899999999993,
            0.16305299999999992,
            0.16268699999999992,
            0.1623209999999999,
            0.1623209999999999,
            0.1623209999999999,
            0.1623209999999999,
            0.1623209999999999,
            0.1623209999999999,
            0.1623209999999999,
            0.1623209999999999,
            0.1623209999999999,
            0.1623209999999999,
            0.1623209999999999,
            0.1623209999999999,
            0.1623209999999999,
            0.1623209999999999,
            0.1623209999999999,
            0.1623209999999999,
            0.1623209999999999,
            0.1623209999999999,
            0.1623209999999999,
            0.1623209999999999,
            0.1623209999999999,
            0.1623209999999999,
            0.1623209999999999,
            0.1623209999999999,
            0.1623209999999999,
            0.1623209999999999,
            0.1623209999999999,
            0.1623209999999999,
            0.1623209999999999,
            0.1623209999999999,
            0.1623209999999999
        ],
        "16": [
            0.182,
            0.181636,
            0.181272,
            0.18090799999999999,
            0.18054399999999998,
            0.18017999999999998,
            0.17781399999999997,
            0.17544799999999997,
            0.17308199999999996,
            0.17071599999999995,
            0.16834999999999994,
            0.16834999999999994,
            0.16798599999999994,
            0.16762199999999994,
            0.16725799999999993,
            0.16689399999999993,
            0.16652999999999993,
            0.16616599999999992,
            0.16580199999999992,
            0.16543799999999992,
            0.16507399999999992,
            0.1647099999999999,
            0.1643459999999999,
            0.1639819999999999,
            0.1636179999999999,
            0.1632539999999999,
            0.1628899999999999,
            0.1625259999999999,
            0.1621619999999999,
            0.1617979999999999,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988
        ],
        "17": [
            0.182,
            0.181636,
            0.181272,
            0.18090799999999999,
            0.18054399999999998,
            0.18017999999999998,
            0.17781399999999997,
            0.17544799999999997,
            0.17308199999999996,
            0.17071599999999995,
            0.16834999999999994,
            0.16834999999999994,
            0.16798599999999994,
            0.16762199999999994,
            0.16725799999999993,
            0.16689399999999993,
            0.16652999999999993,
            0.16616599999999992,
            0.16580199999999992,
            0.16543799999999992,
            0.16507399999999992,
            0.1647099999999999,
            0.1643459999999999,
            0.1639819999999999,
            0.1636179999999999,
            0.1632539999999999,
            0.1628899999999999,
            0.1625259999999999,
            0.1621619999999999,
            0.1617979999999999,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988
        ],
        "18": [
            0.182,
            0.181636,
            0.181272,
            0.18090799999999999,
            0.18054399999999998,
            0.18017999999999998,
            0.17781399999999997,
            0.17544799999999997,
            0.17308199999999996,
            0.17071599999999995,
            0.16834999999999994,
            0.16834999999999994,
            0.16798599999999994,
            0.16762199999999994,
            0.16725799999999993,
            0.16689399999999993,
            0.16652999999999993,
            0.16616599999999992,
            0.16580199999999992,
            0.16543799999999992,
            0.16507399999999992,
            0.1647099999999999,
            0.1643459999999999,
            0.1639819999999999,
            0.1636179999999999,
            0.1632539999999999,
            0.1628899999999999,
            0.1625259999999999,
            0.1621619999999999,
            0.1617979999999999,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988
        ],
        "19": [
            0.182,
            0.181636,
            0.181272,
            0.18090799999999999,
            0.18054399999999998,
            0.18017999999999998,
            0.17781399999999997,
            0.17544799999999997,
            0.17308199999999996,
            0.17071599999999995,
            0.16834999999999994,
            0.16834999999999994,
            0.16798599999999994,
            0.16762199999999994,
            0.16725799999999993,
            0.16689399999999993,
            0.16652999999999993,
            0.16616599999999992,
            0.16580199999999992,
            0.16543799999999992,
            0.16507399999999992,
            0.1647099999999999,
            0.1643459999999999,
            0.1639819999999999,
            0.1636179999999999,
            0.1632539999999999,
            0.1628899999999999,
            0.1625259999999999,
            0.1621619999999999,
            0.1617979999999999,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988
        ],
        "20": [
            0.182,
            0.181636,
            0.181272,
            0.18090799999999999,
            0.18054399999999998,
            0.18017999999999998,
            0.17781399999999997,
            0.17544799999999997,
            0.17308199999999996,
            0.17071599999999995,
            0.16834999999999994,
            0.16834999999999994,
            0.16798599999999994,
            0.16762199999999994,
            0.16725799999999993,
            0.16689399999999993,
            0.16652999999999993,
            0.16616599999999992,
            0.16580199999999992,
            0.16543799999999992,
            0.16507399999999992,
            0.1647099999999999,
            0.1643459999999999,
            0.1639819999999999,
            0.1636179999999999,
            0.1632539999999999,
            0.1628899999999999,
            0.1625259999999999,
            0.1621619999999999,
            0.1617979999999999,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988,
            0.16143399999999988
        ]
    },
    "b": {
        "10": [
            0.228,
            0.227544,
            0.22708799999999998,
            0.22663199999999997,
            0.22617599999999996,
            0.22571999999999995,
            0.22275599999999995,
            0.21979199999999996,
            0.21682799999999997,
            0.21386399999999997,
            0.21089999999999998,
            0.21089999999999998,
            0.21044399999999996,
            0.20998799999999995,
            0.20953199999999994,
            0.20907599999999993,
            0.20861999999999992,
            0.2081639999999999,
            0.2077079999999999,
            0.20725199999999988,
            0.20679599999999987,
            0.20633999999999986,
            0.20588399999999984,
            0.20542799999999983,
            0.20497199999999982,
            0.2045159999999998,
            0.2040599999999998,
            0.20360399999999979,
            0.20314799999999977,
            0.20269199999999976,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975
        ],
        "11": [
            0.228,
            0.227544,
            0.22708799999999998,
            0.22663199999999997,
            0.22617599999999996,
            0.22571999999999995,
            0.22275599999999995,
            0.21979199999999996,
            0.21682799999999997,
            0.21386399999999997,
            0.21089999999999998,
            0.21089999999999998,
            0.21044399999999996,
            0.20998799999999995,
            0.20953199999999994,
            0.20907599999999993,
            0.20861999999999992,
            0.2081639999999999,
            0.2077079999999999,
            0.20725199999999988,
            0.20679599999999987,
            0.20633999999999986,
            0.20588399999999984,
            0.20542799999999983,
            0.20497199999999982,
            0.2045159999999998,
            0.2040599999999998,
            0.20360399999999979,
            0.20314799999999977,
            0.20269199999999976,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975
        ],
        "12": [
            0.228,
            0.227544,
            0.22708799999999998,
            0.22663199999999997,
            0.22617599999999996,
            0.22571999999999995,
            0.22275599999999995,
            0.21979199999999996,
            0.21682799999999997,
            0.21386399999999997,
            0.21089999999999998,
            0.21089999999999998,
            0.21044399999999996,
            0.20998799999999995,
            0.20953199999999994,
            0.20907599999999993,
            0.20861999999999992,
            0.2081639999999999,
            0.2077079999999999,
            0.20725199999999988,
            0.20679599999999987,
            0.20633999999999986,
            0.20588399999999984,
            0.20542799999999983,
            0.20497199999999982,
            0.2045159999999998,
            0.2040599999999998,
            0.20360399999999979,
            0.20314799999999977,
            0.20269199999999976,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975,
            0.20223599999999975
        ],
        "13": [
            0.226,
            0.225548,
            0.225096,
            0.22464399999999998,
            0.22419199999999997,
            0.22373999999999997,
            0.22080199999999997,
            0.21786399999999997,
            0.21492599999999998,
            0.21198799999999998,
            0.20904999999999999,
            0.20904999999999999,
            0.20859799999999998,
            0.20814599999999997,
            0.20769399999999996,
            0.20724199999999995,
            0.20678999999999995,
            0.20633799999999994,
            0.20588599999999993,
            0.20543399999999992,
            0.20498199999999991,
            0.2045299999999999,
            0.2040779999999999,
            0.2036259999999999,
            0.20317399999999988,
            0.20272199999999987,
            0.20226999999999987,
            0.20181799999999986,
            0.20136599999999985,
            0.20091399999999984,
            0.20046199999999983,
            0.20046199999999983,
            0.20046199999999983,
            0.20046199999999983,
            0.20046199999999983,
            0.20046199999999983,
            0.20046199999999983,
            0.20046199999999983,
            0.20046199999999983,
            0.20046199999999983,
            0.20046199999999983,
            0.20046199999999983,
            0.20046199999999983,
            0.20046199999999983,
            0.20046199999999983,
            0.20046199999999983,
            0.20046199999999983,
            0.20046199999999983,
            0.20046199999999983,
            0.20046199999999983,
            0.20046199999999983,
            0.20046199999999983,
            0.20046199999999983,
            0.20046199999999983,
            0.20046199999999983,
            0.20046199999999983,
            0.20046199999999983,
            0.20046199999999983,
            0.20046199999999983,
            0.20046199999999983,
            0.20046199999999983
        ],
        "14": [
            0.224,
            0.223552,
            0.223104,
            0.222656,
            0.222208,
            0.22175999999999998,
            0.218848,
            0.215936,
            0.213024,
            0.210112,
            0.2072,
            0.2072,
            0.206752,
            0.206304,
            0.20585599999999998,
            0.20540799999999998,
            0.20495999999999998,
            0.20451199999999997,
            0.20406399999999997,
            0.20361599999999996,
            0.20316799999999996,
            0.20271999999999996,
            0.20227199999999995,
            0.20182399999999995,
            0.20137599999999994,
            0.20092799999999994,
            0.20047999999999994,
            0.20003199999999993,
            0.19958399999999993,
            0.19913599999999992,
            0.19868799999999992,
            0.19868799999999992,
            0.19868799999999992,
            0.19868799999999992,
            0.19868799999999992,
            0.19868799999999992,
            0.19868799999999992,
            0.19868799999999992,
            0.19868799999999992,
            0.19868799999999992,
            0.19868799999999992,
            0.19868799999999992,
            0.19868799999999992,
            0.19868799999999992,
            0.19868799999999992,
            0.19868799999999992,
            0.19868799999999992,
            0.19868799999999992,
            0.19868799999999992,
            0.19868799999999992,
            0.19868799999999992,
            0.19868799999999992,
            0.19868799999999992,
            0.19868799999999992,
            0.19868799999999992,
            0.19868799999999992,
            0.19868799999999992,
            0.19868799999999992,
            0.19868799999999992,
            0.19868799999999992,
            0.19868799999999992
        ],
        "15": [
            0.223,
            0.222554,
            0.222108,
            0.221662,
            0.221216,
            0.22077,
            0.21787099999999998,
            0.21497199999999997,
            0.21207299999999996,
            0.20917399999999994,
            0.20627499999999993,
            0.20627499999999993,
            0.20582899999999993,
            0.20538299999999993,
            0.20493699999999992,
            0.20449099999999992,
            0.20404499999999992,
            0.20359899999999992,
            0.20315299999999992,
            0.20270699999999992,
            0.2022609999999999,
            0.2018149999999999,
            0.2013689999999999,
            0.2009229999999999,
            0.2004769999999999,
            0.2000309999999999,
            0.1995849999999999,
            0.1991389999999999,
            0.1986929999999999,
            0.1982469999999999,
            0.1978009999999999,
            0.1978009999999999,
            0.1978009999999999,
            0.1978009999999999,
            0.1978009999999999,
            0.1978009999999999,
            0.1978009999999999,
            0.1978009999999999,
            0.1978009999999999,
            0.1978009999999999,
            0.1978009999999999,
            0.1978009999999999,
            0.1978009999999999,
            0.1978009999999999,
            0.1978009999999999,
            0.1978009999999999,
            0.1978009999999999,
            0.1978009999999999,
            0.1978009999999999,
            0.1978009999999999,
            0.1978009999999999,
            0.1978009999999999,
            0.1978009999999999,
            0.1978009999999999,
            0.1978009999999999,
            0.1978009999999999,
            0.1978009999999999,
            0.1978009999999999,
            0.1978009999999999,
            0.1978009999999999,
            0.1978009999999999
        ],
        "16": [
            0.222,
            0.221556,
            0.221112,
            0.220668,
            0.220224,
            0.21978,
            0.216894,
            0.214008,
            0.211122,
            0.208236,
            0.20535,
            0.20535,
            0.204906,
            0.204462,
            0.204018,
            0.203574,
            0.20313,
            0.202686,
            0.202242,
            0.201798,
            0.201354,
            0.20091,
            0.200466,
            0.200022,
            0.199578,
            0.199134,
            0.19869,
            0.198246,
            0.197802,
            0.197358,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914
        ],
        "17": [
            0.222,
            0.221556,
            0.221112,
            0.220668,
            0.220224,
            0.21978,
            0.216894,
            0.214008,
            0.211122,
            0.208236,
            0.20535,
            0.20535,
            0.204906,
            0.204462,
            0.204018,
            0.203574,
            0.20313,
            0.202686,
            0.202242,
            0.201798,
            0.201354,
            0.20091,
            0.200466,
            0.200022,
            0.199578,
            0.199134,
            0.19869,
            0.198246,
            0.197802,
            0.197358,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914
        ],
        "18": [
            0.222,
            0.221556,
            0.221112,
            0.220668,
            0.220224,
            0.21978,
            0.216894,
            0.214008,
            0.211122,
            0.208236,
            0.20535,
            0.20535,
            0.204906,
            0.204462,
            0.204018,
            0.203574,
            0.20313,
            0.202686,
            0.202242,
            0.201798,
            0.201354,
            0.20091,
            0.200466,
            0.200022,
            0.199578,
            0.199134,
            0.19869,
            0.198246,
            0.197802,
            0.197358,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914
        ],
        "19": [
            0.222,
            0.221556,
            0.221112,
            0.220668,
            0.220224,
            0.21978,
            0.216894,
            0.214008,
            0.211122,
            0.208236,
            0.20535,
            0.20535,
            0.204906,
            0.204462,
            0.204018,
            0.203574,
            0.20313,
            0.202686,
            0.202242,
            0.201798,
            0.201354,
            0.20091,
            0.200466,
            0.200022,
            0.199578,
            0.199134,
            0.19869,
            0.198246,
            0.197802,
            0.197358,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914
        ],
        "20": [
            0.222,
            0.221556,
            0.221112,
            0.220668,
            0.220224,
            0.21978,
            0.216894,
            0.214008,
            0.211122,
            0.208236,
            0.20535,
            0.20535,
            0.204906,
            0.204462,
            0.204018,
            0.203574,
            0.20313,
            0.202686,
            0.202242,
            0.201798,
            0.201354,
            0.20091,
            0.200466,
            0.200022,
            0.199578,
            0.199134,
            0.19869,
            0.198246,
            0.197802,
            0.197358,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914,
            0.196914
        ]
    },
    "c": {
        "10": [
            0.193,
            0.192614,
            0.192228,
            0.191842,
            0.19145600000000002,
            0.19107000000000002,
            0.188561,
            0.186052,
            0.18354299999999998,
            0.18103399999999997,
            0.17852499999999996,
            0.17852499999999996,
            0.17813899999999996,
            0.17775299999999997,
            0.17736699999999997,
            0.17698099999999997,
            0.17659499999999997,
            0.17620899999999998,
            0.17582299999999998,
            0.17543699999999998,
            0.17505099999999998,
            0.174665,
            0.174279,
            0.173893,
            0.173507,
            0.173121,
            0.172735,
            0.172349,
            0.171963,
            0.171577,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191
        ],
        "11": [
            0.193,
            0.192614,
            0.192228,
            0.191842,
            0.19145600000000002,
            0.19107000000000002,
            0.188561,
            0.186052,
            0.18354299999999998,
            0.18103399999999997,
            0.17852499999999996,
            0.17852499999999996,
            0.17813899999999996,
            0.17775299999999997,
            0.17736699999999997,
            0.17698099999999997,
            0.17659499999999997,
            0.17620899999999998,
            0.17582299999999998,
            0.17543699999999998,
            0.17505099999999998,
            0.174665,
            0.174279,
            0.173893,
            0.173507,
            0.173121,
            0.172735,
            0.172349,
            0.171963,
            0.171577,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191
        ],
        "12": [
            0.193,
            0.192614,
            0.192228,
            0.191842,
            0.19145600000000002,
            0.19107000000000002,
            0.188561,
            0.186052,
            0.18354299999999998,
            0.18103399999999997,
            0.17852499999999996,
            0.17852499999999996,
            0.17813899999999996,
            0.17775299999999997,
            0.17736699999999997,
            0.17698099999999997,
            0.17659499999999997,
            0.17620899999999998,
            0.17582299999999998,
            0.17543699999999998,
            0.17505099999999998,
            0.174665,
            0.174279,
            0.173893,
            0.173507,
            0.173121,
            0.172735,
            0.172349,
            0.171963,
            0.171577,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191,
            0.171191
        ],
        "13": [
            0.191,
            0.190618,
            0.19023600000000002,
            0.18985400000000002,
            0.18947200000000003,
            0.18909000000000004,
            0.18660700000000002,
            0.184124,
            0.181641,
            0.17915799999999998,
            0.17667499999999997,
            0.17667499999999997,
            0.17629299999999998,
            0.17591099999999998,
            0.175529,
            0.175147,
            0.174765,
            0.174383,
            0.17400100000000002,
            0.17361900000000002,
            0.17323700000000003,
            0.17285500000000004,
            0.17247300000000004,
            0.17209100000000005,
            0.17170900000000006,
            0.17132700000000006,
            0.17094500000000007,
            0.17056300000000008,
            0.17018100000000008,
            0.1697990000000001,
            0.1694170000000001,
            0.1694170000000001,
            0.1694170000000001,
            0.1694170000000001,
            0.1694170000000001,
            0.1694170000000001,
            0.1694170000000001,
            0.1694170000000001,
            0.1694170000000001,
            0.1694170000000001,
            0.1694170000000001,
            0.1694170000000001,
            0.1694170000000001,
            0.1694170000000001,
            0.1694170000000001,
            0.1694170000000001,
            0.1694170000000001,
            0.1694170000000001,
            0.1694170000000001,
            0.1694170000000001,
            0.1694170000000001,
            0.1694170000000001,
            0.1694170000000001,
            0.1694170000000001,
            0.1694170000000001,
            0.1694170000000001,
            0.1694170000000001,
            0.1694170000000001,
            0.1694170000000001,
            0.1694170000000001,
            0.1694170000000001
        ],
        "14": [
            0.189,
            0.188622,
            0.18824400000000002,
            0.18786600000000003,
            0.18748800000000004,
            0.18711000000000005,
            0.18465300000000007,
            0.18219600000000008,
            0.1797390000000001,
            0.1772820000000001,
            0.17482500000000012,
            0.17482500000000012,
            0.17444700000000013,
            0.17406900000000014,
            0.17369100000000015,
            0.17331300000000016,
            0.17293500000000017,
            0.17255700000000018,
            0.1721790000000002,
            0.1718010000000002,
            0.17142300000000021,
            0.17104500000000022,
            0.17066700000000024,
            0.17028900000000025,
            0.16991100000000026,
            0.16953300000000027,
            0.16915500000000028,
            0.1687770000000003,
            0.1683990000000003,
            0.1680210000000003,
            0.16764300000000032,
            0.16764300000000032,
            0.16764300000000032,
            0.16764300000000032,
            0.16764300000000032,
            0.16764300000000032,
            0.16764300000000032,
            0.16764300000000032,
            0.16764300000000032,
            0.16764300000000032,
            0.16764300000000032,
            0.16764300000000032,
            0.16764300000000032,
            0.16764300000000032,
            0.16764300000000032,
            0.16764300000000032,
            0.16764300000000032,
            0.16764300000000032,
            0.16764300000000032,
            0.16764300000000032,
            0.16764300000000032,
            0.16764300000000032,
            0.16764300000000032,
            0.16764300000000032,
            0.16764300000000032,
            0.16764300000000032,
            0.16764300000000032,
            0.16764300000000032,
            0.16764300000000032,
            0.16764300000000032,
            0.16764300000000032
        ],
        "15": [
            0.188,
            0.187624,
            0.18724800000000003,
            0.18687200000000004,
            0.18649600000000005,
            0.18612000000000006,
            0.18367600000000006,
            0.18123200000000006,
            0.17878800000000006,
            0.17634400000000006,
            0.17390000000000005,
            0.17390000000000005,
            0.17352400000000007,
            0.17314800000000008,
            0.1727720000000001,
            0.1723960000000001,
            0.17202000000000012,
            0.17164400000000013,
            0.17126800000000014,
            0.17089200000000015,
            0.17051600000000017,
            0.17014000000000018,
            0.1697640000000002,
            0.1693880000000002,
            0.16901200000000022,
            0.16863600000000023,
            0.16826000000000024,
            0.16788400000000026,
            0.16750800000000027,
            0.16713200000000028,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003,
            0.1667560000000003
        ],
        "16": [
            0.187,
            0.186626,
            0.18625199999999997,
            0.18587799999999996,
            0.18550399999999995,
            0.18512999999999993,
            0.18269899999999994,
            0.18026799999999996,
            0.17783699999999997,
            0.17540599999999998,
            0.172975,
            0.172975,
            0.17260099999999998,
            0.17222699999999996,
            0.17185299999999995,
            0.17147899999999994,
            0.17110499999999992,
            0.1707309999999999,
            0.1703569999999999,
            0.16998299999999988,
            0.16960899999999987,
            0.16923499999999986,
            0.16886099999999984,
            0.16848699999999983,
            0.16811299999999982,
            0.1677389999999998,
            0.1673649999999998,
            0.16699099999999978,
            0.16661699999999977,
            0.16624299999999975,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974
        ],
        "17": [
            0.187,
            0.186626,
            0.18625199999999997,
            0.18587799999999996,
            0.18550399999999995,
            0.18512999999999993,
            0.18269899999999994,
            0.18026799999999996,
            0.17783699999999997,
            0.17540599999999998,
            0.172975,
            0.172975,
            0.17260099999999998,
            0.17222699999999996,
            0.17185299999999995,
            0.17147899999999994,
            0.17110499999999992,
            0.1707309999999999,
            0.1703569999999999,
            0.16998299999999988,
            0.16960899999999987,
            0.16923499999999986,
            0.16886099999999984,
            0.16848699999999983,
            0.16811299999999982,
            0.1677389999999998,
            0.1673649999999998,
            0.16699099999999978,
            0.16661699999999977,
            0.16624299999999975,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974
        ],
        "18": [
            0.187,
            0.186626,
            0.18625199999999997,
            0.18587799999999996,
            0.18550399999999995,
            0.18512999999999993,
            0.18269899999999994,
            0.18026799999999996,
            0.17783699999999997,
            0.17540599999999998,
            0.172975,
            0.172975,
            0.17260099999999998,
            0.17222699999999996,
            0.17185299999999995,
            0.17147899999999994,
            0.17110499999999992,
            0.1707309999999999,
            0.1703569999999999,
            0.16998299999999988,
            0.16960899999999987,
            0.16923499999999986,
            0.16886099999999984,
            0.16848699999999983,
            0.16811299999999982,
            0.1677389999999998,
            0.1673649999999998,
            0.16699099999999978,
            0.16661699999999977,
            0.16624299999999975,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974
        ],
        "19": [
            0.187,
            0.186626,
            0.18625199999999997,
            0.18587799999999996,
            0.18550399999999995,
            0.18512999999999993,
            0.18269899999999994,
            0.18026799999999996,
            0.17783699999999997,
            0.17540599999999998,
            0.172975,
            0.172975,
            0.17260099999999998,
            0.17222699999999996,
            0.17185299999999995,
            0.17147899999999994,
            0.17110499999999992,
            0.1707309999999999,
            0.1703569999999999,
            0.16998299999999988,
            0.16960899999999987,
            0.16923499999999986,
            0.16886099999999984,
            0.16848699999999983,
            0.16811299999999982,
            0.1677389999999998,
            0.1673649999999998,
            0.16699099999999978,
            0.16661699999999977,
            0.16624299999999975,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974
        ],
        "20": [
            0.187,
            0.186626,
            0.18625199999999997,
            0.18587799999999996,
            0.18550399999999995,
            0.18512999999999993,
            0.18269899999999994,
            0.18026799999999996,
            0.17783699999999997,
            0.17540599999999998,
            0.172975,
            0.172975,
            0.17260099999999998,
            0.17222699999999996,
            0.17185299999999995,
            0.17147899999999994,
            0.17110499999999992,
            0.1707309999999999,
            0.1703569999999999,
            0.16998299999999988,
            0.16960899999999987,
            0.16923499999999986,
            0.16886099999999984,
            0.16848699999999983,
            0.16811299999999982,
            0.1677389999999998,
            0.1673649999999998,
            0.16699099999999978,
            0.16661699999999977,
            0.16624299999999975,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974,
            0.16586899999999974
        ]
    }
};

const cda_lookup = [2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12];

//-//Environment
const wind_angle = 30;
const headwind = wind_angle - 180;
const density = 1.13;

//-//Power input % of CP:
var steady_state = 0.91;
var over_threshold = 1.10;
var descending = 0.02;
// steady_state *= cp;
// over_threshold *= cp;
// descending *= cp;

//-//Slope threshold below/above which rider comes off steady state power
const min_slope = -0.01;
const max_slope = 0.075;
//-//Slope threshold below/above which rider comes off seated position
const descending_slope = -0.01;
const climbing_slope = 0.03;

//-//Bike
const crr = 0.0025;
const mech_eff = 0.98;
const moi_front = 0.08;
const moi_rear = 0.08;
const wheel_radius = 0.335;

var dists = [0.1];
var speeds = [0.3];
var times = [0];

let dist = dists[0];
let speed = speeds[0];

var km_hr = [speed * 3.6];

// Position at each point
let positions = ['b'];
for (let i = 0; i < L; i++) {
    if (slope_percents[i] < descending_slope) {
        positions.push('c');
    }
    else if (slope_percents[i] > climbing_slope) {
        positions.push('b');
    }
    else {
        positions.push('a');
    }
}

// Prediction for course.
let i = 0

while (i < L-1) {

    // 1. Calculate Relative Wind Angle
    let rel_wind_angle = bearings[i] - headwind;

    // 2. Get the wind-speed at the ground with lookup tables.
    //               Class  |z0 length |mv   |m/sec
    // Race circuit  open	 2	        0.1	  1.0
    // Tree-lined,   light	 2.5	    0.2	  0.8
    // Tree-lined,   medium	 3	        0.4	  0.6
    // Tree-lined    dense	 3.5	    0.8   0.2

    // Segment	Roughness class		
    // 1	2		
    // 2	2.5		
    // 3	3		
    // 4	3.5		
    // 5	3.5		
    // 6	3.5		
    // 7	3		
    // 8	2.5		
    // 9	2		
    // For now we will just use a constant value '1'
    let wind_speed = 1;

    // 3. Calculate the effective yaw angle
    effectiveYaw = degrees(Math.atan(wind_speed * Math.sin(radians(rel_wind_angle)) / (speed + wind_speed * Math.cos(radians(rel_wind_angle)))))
    yaw_abs.push(Math.abs(effectiveYaw));

    // 4. Lookup power input and position based on location on the course
    let slope = slopes[i];
    let power = mech_eff * cp;
    if (slope < min_slope) {
        power *= descending;
    } else if (slope > max_slope) {
        power *= over_threshold;
    } else {
        power *= steady_state;
    }
    power += delta_watts;
    power_in.push(power);
    
    let pos = positions[i]   // Where do 'segments' columns come from?

    // 5. Calculate power components for aero, rolling resistance and slope
    //=@Speed+@Wind_speed___1m*COS(RADIANS(@Relative_wind_angle)))^2+(@Wind_speed___1m*SIN(RADIANS(@Relative_wind_angle)
    let rel_wind_speed = Math.sqrt(
		Math.pow(( speed + wind_speed * Math.cos(radians(rel_wind_angle)) ),2) + 
		Math.pow(( wind_speed * Math.sin(radians(rel_wind_angle)) ),2)
	   );
    
    let cda = delta_cda + all_CDAs[pos][cda_lookup[Math.floor(rel_wind_speed)] + 8][Math.floor(Math.abs(effectiveYaw))];
    cdas.push(cda)

    let power_aero = 0.5 * density * Math.pow(rel_wind_speed, 3) * cda;
    let power_roll = mass_total * crr * 9.81 * speed;
    let power_gravity = slope * 9.81 * mass_total * speed;

    // 6. Net power = @Power_in-@Power_aero-@Power_roll-@Power_gravity
    let power_net = power - power_aero - power_roll - power_gravity;

    // 7. Net propulsive force = net_power/speed
    let propulsive_force = power_net / speed;

    // 8. Acceleration = F/m
    let accel = propulsive_force / (mass_total + (moi_front / Math.pow(wheel_radius, 2)) + (moi_rear / Math.pow(wheel_radius, 2)));

    // 9. Calcs to update Wâ€™ balance
    let DCp = Math.max(0, -(power / mech_eff - cp));
    // =IF((L3*(1/Mech_eff))*dt,0)
    let OT_energy = 0;
    if (power_in / mech_eff - cp > 0) {
        OT_energy = dt * power / mech_eff;
    }

    // Calculation for t'
    // Excel formula is: =IF('Input-Output'!$F$2=1,IFERROR(2287.2*X2^-0.688,0),IF('Input-Output'!$F$2=2,IFERROR(wprime/Calcs!X2,0),IF('Input-Output'!$F$2=3,IFERROR(546*EXP(-0.01*Calcs!X2)+316,0))))
    if (w_recovery_function == 1) {
        tw = 2287.2 * Math.pow(DCp, -0.688);
    }
    else if (w_recovery_function == 2) {
        tw = wprime / DCp;
    }
    else if (w_recovery_function == 3) {
        tw = (546 * Math.exp(-0.01 * DCp)) + 316;
    }
    else {
        tw = 0;
    }

    // Calculation for wprime
    // Excel formula: =IF(X2=0,AA1-Y2,wprime-(wprime-AA1)*EXP(-dt/Z2))
    if (DCp == 0) {
        wprime_ -= OT_energy; 
    }
    else {
        wprime_ = wprime - (wprime - wprime_) * Math.exp((-dt)/tw);
    }
    wprimes.push(wprime_);
    console.log(times[times.length - 1] + dt, dist, speed, slope_percents[i], pos, cda);
    
    // Update velocity and distance
    speed += accel * dt;
    dist += speed * dt;
    speeds.push(speed);
    km_hr.push(speed * 3.6);
    dists.push(dist);
    times.push(times[times.length - 1] + dt);


    // Increment i
    if (dist >= distances[i + 1]) { i++; }
}
